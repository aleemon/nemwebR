---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# nemwebR

<!-- badges: start -->
<!-- badges: end -->

The goal of `nemwebR` is to enable easy downloading of datasets from the [AEMO NEM Web site](https://www.aemo.com.au/energy-systems/electricity/national-electricity-market-nem/data-nem/market-data-nemweb). `nemwebR` has a series of functions for fetching common datasets such as market prices, generator outputs or bids.

`nemwebR` is designed specifically for those looking to access market data but without access to the MMS Data Model typically available to registered market participants. The likely user is someone looking to run ad hoc analyses on NEM data, primarily on historical (> 2 months old) datasets.

The naming and design of these functions is intended to mirror the naming and conventions of the [MMS Data Model Report](http://nemweb.com.au/Reports/Current/MMSDataModelReport/Electricity/MMS%20Data%20Model%20Report_files/MMS_2.htm). For clarity, only _public_ datasets (or _private; public next day_) are available.

## Notes

"Why does this package exist if I can just download the csv files from NEMWeb?" Great question. Here's why:

* AEMO csv headers and footers are removed so that the data is ready to use in a clean tabular format
* csv files containing multiple datasets are split out into their consituent datasets
* Empty and deprecated columns are stripped out to keep the final data cleaner
* When dealing with dispatch datasets intervention hierarchies have been implemented correctly
* All dates and times are formatted in POSIX +10 timezone (Australia/Brisbane)
* Data types have all been strictly enforced


Depending on the volume of data and update frequency in a given dataset,archive (historical) data usually starts from ~ 2 weeks prior and stretches back to July 2009. Current (recent) data usually stretches back ~ 1 year. The archive functions are typically faster and more efficient than the current functions, so try to use them where possible.

For high volume versioned datasets (i.e. the predispatch and bidding data) the current data contains all versions whereas the archive data only keeps the latest value (i.e. the current data retrieves BIDDAYOFFER whereas the archive retrieves BIDDAYOFFER_D). Unfortunately this somewhat limits the value of analysis from these datasets and is just one of many quirks of the data available on NEMWeb. 

## Five Minute Settlement

As of 1 October 2021 the NEM is dispatched and settled in 5 minute intervals (previously the NEM was dispatched in 5 minute intervals and settled on 30 minute intervals). The old 30 minute interval _trading_ datasets are no longer valid for new data, but exist for historical purposes.  


## Available Datasets - Archive

### Dispatch Data
* DISPATCH_FCAS_REQ -- Regional FCAS requirements
* DISPATCHLOAD -- Scheduled and semi-scheduled generator outputs
* DISPATCHPRICE -- Regional prices
* DISPATCHREGIONSUM -- Regional demand and non-scheduled generation


### Generator Registration data
* DUDETAILSUMMARY -- Summary of registration details for all registered generators
* DUDETAIL -- Registration details for all registered generators
* GENUNITS -- Summary of individual unit registration details, including fuel type and CO~2~ emission information

### Bid Data
* BIDDAYOFFER -- Bid price band data for energy and FCAS markets submitted by generators
* BIDPEROFFER -- Bid generation volumes for energy and FCAS markets submitted by generators
* BIDDUIDDETAILS -- Enablement levels and FCAS trapezium ffor each generator


### Trading Data (Historical 30-minute data)
_Note that these data are no longer updated as of 1 October 2021_

* TRADINGINTERCONNECT -- Interconnector flows and limits
* TRADINGLOAD -- Scheduled and semi-scheduled generator outputs
* TRADINGPRICE -- Regional prices
* TRADINGREGIONSUM -- Regional demand and non-scheduled generation



## Available Datasets - Current

* DISPATCHPRICE (incomplete)



## Non-NEMWeb data

* Net System Load Profiles -- Annual NSLP data for 2002 onwards



## Installation

Install the current version from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("aleemon/nemwebR")
```
## Example

A (very) basic example of fetching pricing data:

```{r example}
library(nemwebR)
library(purrr)

## fetch 30-minute pricing data for the first 3 months of 2020
input <- seq(20200101, 20200301, by = 100)

prices_q1_2020 <- map_dfr(input, nemwebR_archive_tradingprice)

head(prices_q1_2020)

```


## Development

nemwebR is under active development and features may be added or removed. There are number of obvious areas for improvement, but the core functions are sufficient for many analysis applications.

Future improvements:

* Speed improvements -- the functions are currently built on the base `read.csv()` function which is significantly slower than either `dplyr::read_csv()` or `data.table::fread()`. Unfortunately these functions don't play nice with the awkward formatting of AEMO csv files.

* Efficiently pulling in report data from across the archive and current datasets

* Change the datestring entry over to a more logical YYYYMM format

* Improve the error handling and error messaging


### Future Datasets

* BIDDAYOFFER_D (Probably not)
* BIDPEROFFER_D (Probably not)
* DISPATCHCONSTRAINT
* DISPATCHINTERCONNECTORRES
* DISPATCHCASE_OCD
* CONSTRAINTRELAXATION_OCD
* GENCONDATA
* GENCONSET
* GENCONSETINVOKE
* GENERICCONSTRAINTRHS
* GENERICEQUATIONDESC
* GENERICEQUATIONRHS
* INTERCONNECTOR
* INTERCONNECTORCONSTRAINT
* LOSSFACTORMODEL
* LOSSMODEL
* MARKET_PRICE_THRESHOLDS
* MARKETFEE
* MARKETFEEDATA
* MARKETNOTICEDATA
* MARKETNOTICETYPE
* MTPASA datasates
* P5MIN datasets
* PDPASA datasets
* PREDISPATCH datasets
* RESIDUE datasets
* ROOFTOP_PV_ACTUAL
* ROOFTOP_PV_FORECAST
* STPASA datasets
* TRANSMISSIONLOSSFACTOR
